/* ===== Page Layout ===== */
.main-container{
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Header */
.app-header{
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 28px 32px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-color);
}
.header-content{
  display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:16px;
}
.brand-section h1{
  font-weight:800; font-size:2.2rem; margin:0;
  background: var(--gradient-text);
  -webkit-background-clip: text; background-clip: text;
  -webkit-text-fill-color: transparent;
}
.app-subtitle{ color:var(--text-secondary); margin:8px 0 0; }
.header-controls{ display:flex; align-items:center; gap:16px; }

.status-badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:12px 18px; border-radius:16px; font-weight:700;
  border:2px solid transparent; text-transform:uppercase; letter-spacing:.5px;
}
.status-badge.loaded { background:var(--success-bg); color:var(--success-color); border-color:var(--success-color); }
.status-badge.not-loaded { background:var(--error-bg); color:var(--error-color); border-color:var(--error-color); }
.status-badge.loading { background:var(--warning-bg); color:var(--warning-color); border-color:var(--warning-color); }

.theme-toggle{
  background: var(--card-bg);
  border: 2px solid var(--border-color);
  border-radius: 16px; width: 52px; height: 52px;
  display:flex; align-items:center; justify-content:center; cursor:pointer;
  transition: var(--transition-normal);
}
.theme-toggle:hover{ background: var(--hover-bg); transform: translateY(-2px) scale(1.05); box-shadow:var(--shadow-md); }

/* Cards */
.control-card, .results-card{
  background: var(--card-bg);
  border-radius: 20px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-color);
  overflow: hidden;
}
.card-header{
  padding:24px 32px 16px; border-bottom:1px solid var(--border-color);
  display:flex; align-items:center; justify-content:space-between; gap:16px;
}
.card-header h3{ margin:0; font-weight:700; display:flex; gap:12px; align-items:center; }
.card-body{ padding: 32px; }

/* Buttons */
.btn-modern{
  padding: 14px 24px; border: none; border-radius: 12px;
  font-weight: 600; cursor: pointer; transition: var(--transition-normal);
  display:inline-flex; align-items:center; gap:8px; text-decoration:none; white-space:nowrap;
}
.btn-primary-modern{ background: var(--gradient-primary); color:#fff; box-shadow:var(--shadow-md); }
.btn-primary-modern:hover{ transform:translateY(-2px); box-shadow:var(--shadow-xl); }
.btn-secondary-modern{ background: var(--card-bg); color: var(--text-primary); border:2px solid var(--border-color); }
.btn-secondary-modern:hover{ background:var(--hover-bg); transform:translateY(-1px); box-shadow:var(--shadow-sm); border-color:var(--primary-color); }
.btn-sm{ padding:8px 16px; font-size:.9rem; }

/* Selects */
.criteria-select, .form-select{
  width:100%; padding:16px 20px; border:2px solid var(--border-color); border-radius:12px;
  background: var(--input-bg); color: var(--text-primary); font-weight:600;
  transition: var(--transition-normal); appearance:none;
  background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position:right 12px center; background-repeat:no-repeat; background-size:16px; padding-right:48px;
}
.criteria-select:hover, .criteria-select:focus, .form-select:hover, .form-select:focus{
  border-color: var(--primary-color); outline:none; box-shadow: 0 0 0 3px var(--primary-shadow);
}

/* Layout rows */
.criteria-row{
  display:grid; grid-template-columns:1fr auto; gap:24px; align-items:end;
}
.dual-criteria-row{
  display:grid; grid-template-columns:1fr auto 1fr auto; gap:24px; align-items:end;
}
.criteria-group{ display:flex; flex-direction:column; gap:8px; }
.criteria-separator{ display:flex; align-items:center; justify-content:center; color:var(--text-secondary); }
.criteria-execute{ display:flex; align-items:end; }

/* Filters */
.filters-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:24px; }
.filter-chips{ display:flex; gap:8px; flex-wrap:wrap; }
.filter-chip{ padding:10px 18px; border:2px solid var(--border-color); border-radius:20px; background:var(--card-bg); cursor:pointer; user-select:none; font-weight:700; }
.filter-chip.active{ background: var(--primary-color); color:#fff; border-color: var(--primary-color); }

.slider-container{ margin: 6px 8px 0; min-height:40px; }
.slider-labels{ display:flex; justify-content:space-between; margin-top:8px; color:var(--text-secondary); }

.active-filters{ min-height:2.5rem; display:flex; align-items:center; gap:6px; flex-wrap:wrap; padding:12px; background:var(--input-bg); border:1px solid var(--border-color); border-radius:8px; }
.active-filters .text-muted{ font-style: italic; }

/* Results */
.results-header{ display:flex; justify-content:space-between; align-items:center; padding:24px 32px; border-bottom:1px solid var(--border-color); background: var(--table-header-bg); }
.results-info{ display:flex; gap:16px; align-items:center; }
.results-count{ font-size:1.4rem; font-weight:700; }
.results-toolbar{ display:flex; gap:8px; align-items:center; }
.btn-export{ padding:10px 16px; border:1px solid var(--border-color); background:var(--card-bg); border-radius:10px; font-weight:600; cursor:pointer; transition: var(--transition-fast); display:flex; align-items:center; gap:6px; }

.table-container{ position:relative; min-height:200px; }
.empty-state{ display:flex; align-items:center; justify-content:center; min-height:400px; background:var(--table-bg); }
.empty-state-content{ text-align:center; padding:40px; max-width:420px; }
.empty-state-content .material-icons{ font-size:4rem; color:var(--text-muted); margin-bottom:16px; display:block; }

/* Loading overlay */
.loading-overlay{ position:fixed; inset:0; background: rgba(0,0,0,.3); display:none; z-index: 9998; }
.loading-content{ position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:var(--card-bg); padding:24px 28px; border-radius:14px; box-shadow:var(--shadow-lg); border:1px solid var(--border-color); display:flex; gap:12px; align-items:center; }
.loading-spinner{ width:20px; height:20px; border-radius:50%; border:3px solid var(--border-color); border-top-color: var(--primary-color); animation: spin 1s linear infinite; }
@keyframes spin{ to{ transform: rotate(360deg);} }

/* DataTables theme tweaks */
.dataTables_wrapper{ color:var(--text-primary); padding: 24px 32px; }
table.dataTable thead th{ background: var(--table-header-bg) !important; text-transform: uppercase; font-weight:800; letter-spacing:.5px; }
table.dataTable tbody tr:hover{ background: var(--table-hover-bg) !important; }

/* Animations */
.fade-in{ animation: fadein .25s ease both; }
.slide-up{ animation: slideup .3s ease both; }
@keyframes fadein{ from { opacity:0; transform:translateY(4px); } to { opacity:1; transform:none; } }
@keyframes slideup{ from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:none; } }


/* ===== Control sections (no tabs) ===== */
.control-sections{
  display: grid;
  grid-template-columns: 1fr;
  gap: 20px;
}
@media (min-width: 1100px){
  .control-sections{ grid-template-columns: 1fr 1fr; }
}
.section-card{
  border: 1px solid var(--border-color);
  border-radius: 16px;
  overflow: hidden;
  background: var(--input-bg);
  box-shadow: var(--shadow-sm);
}
.section-header{
  display:flex; align-items:center; justify-content:space-between; gap:16px;
  padding: 16px 20px; border-bottom: 1px solid var(--border-light);
  background: var(--table-header-bg);
}
.section-title{ display:flex; gap:12px; align-items:center; }
.section-title h4{ margin:0; font-weight:800; }
.section-title .muted{ margin:0; color: var(--text-secondary); font-size:.9rem; }
.section-actions{ display:flex; gap:10px; align-items:center; }
.section-body{ padding: 16px 20px; background: var(--card-bg); }

.filters-placeholder{ padding: 6px 2px 0; color: var(--text-muted); }


/* Segmented sections header (pannello di controllo) */
#controlTabs{
  background: var(--table-header-bg);
  border-radius: 14px;
  padding: 6px;
  border: 1px solid var(--border-color);
}
#controlTabs .nav-link{
  border-radius: 10px;
  font-weight: 700;
  padding: 10px 18px;
  color: var(--text-secondary);
  transition: var(--transition-fast);
}
#controlTabs .nav-link.active{
  background: var(--card-bg);
  box-shadow: var(--shadow-sm);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}
#controlTabs .nav-link:not(.active):hover{ background: var(--hover-bg); }


/* Tabs container spacing when header is removed */
.control-card .card-body { padding-top: 20px; }


/* === New compact panel styled like the mockup === */
.controls-bar{
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
  overflow: hidden;
}
.controls-tabs{
  display:flex; background: var(--table-header-bg); border-bottom:1px solid var(--border-color);
}
.control-tab{
  flex:1; padding:14px 16px; background:transparent; border:none; cursor:pointer;
  color: var(--text-secondary); font-weight:600; display:flex; align-items:center; justify-content:center; gap:8px;
  transition: var(--transition-fast);
}
.control-tab:hover{ background: var(--hover-bg); color: var(--text-primary); }
.control-tab.active{ background: var(--card-bg); color: var(--primary-color); border-bottom: 2px solid var(--primary-color); }

.control-panel{ display:none; }
.control-panel.active{ display:block; }
.control-panel-inner{ padding: 18px 22px; }
.panel-title{
  font-size:.8rem; font-weight:800; color:var(--text-secondary); letter-spacing:.08em; margin-bottom:10px; text-transform:uppercase;
}
.panel-row{
  display:flex; gap:14px; align-items: center;
}
.panel-row.dual{ display:grid; grid-template-columns: 1fr auto 1fr auto; align-items:center; }

/* Gradient primary button like mockup */
.btn-gradient{
  background: linear-gradient(135deg,#5b6cfb 0%, #7f56f2 100%);
  color: #fff; border: none; border-radius: 12px; padding: 12px 20px; font-weight:700;
  box-shadow: 0 6px 16px rgba(127,86,242,.25);
}
.btn-gradient:hover{ transform: translateY(-1px); box-shadow: 0 10px 20px rgba(127,86,242,.35); }

/* Icon round button (reload) */
.btn-icon{
  width: 48px; height: 48px; border-radius: 12px; display:flex; align-items:center; justify-content:center;
  background: var(--card-bg); border:2px solid var(--border-color); color: var(--text-primary);
  transition: var(--transition-fast);
}
.btn-icon:hover{ background: var(--hover-bg); border-color: var(--primary-color); transform: translateY(-1px); }

/* Adjust select spacing to look like screenshot */
.criteria-select-wrapper{ flex:1; }
.criteria-select{ height:58px; }

/* Responsive tweaks */
@media (max-width: 768px){
  .panel-row{ flex-direction: column; align-items: stretch; }
  .panel-row.dual{ grid-template-columns: 1fr; }
}


.cache-controls {
    display: flex;
    gap: 8px;
    align-items: center;
}

.btn-cache-action {
    padding: 6px 12px;
    border: 1px solid var(--border-color);
    background: var(--card-bg);
    border-radius: 8px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: var(--transition-fast);
    display: flex;
    align-items: center;
    gap: 4px;
}

.btn-cache-action:hover {
    background: var(--hover-bg);
    border-color: var(--primary-color);
}

.btn-cache-action.force-refresh {
    color: var(--warning-color);
    border-color: var(--warning-color);
}

.btn-cache-action.force-refresh:hover {
    background: var(--warning-bg);
}

.cache-info-display {
    font-size: 0.75rem;
    color: var(--text-muted);
    padding: 4px 8px;
    background: var(--input-bg);
    border-radius: 6px;
    border: 1px solid var(--border-light);
}

/* --- FIX select criteri/fantasquadre in mobile --- */
@media (max-width: 768px){
  /* Passa la griglia del “Doppio” a layout verticale */
  .panel-row.dual{
    display: flex;             /* override della griglia */
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }

  /* Wrapper Fantasquadra: impila label + select */
  #prevTeamWrapper,
  #prevTeamWrapperA,
  #prevTeamWrapperB{
    flex-direction: column !important;
    align-items: stretch !important;
    gap: 6px !important;
  }
  #prevTeamWrapper .form-label,
  #prevTeamWrapperA .form-label,
  #prevTeamWrapperB .form-label{
    margin: 0 0 4px !important;
  }
}

/* Evita overflow dei select dentro container flessibili */
.criteria-select,
.form-select{
  min-width: 0;   /* fondamentale per farli adattare in flex/grid */
}

/* **HEADER RESPONSIVO MIGLIORATO** */
.app-header {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border-radius: 0 0 20px 20px;
  padding: 28px 32px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-color);
  border-top: none;
  position: sticky;
  top: 0;
  z-index: 999;
  margin: 0 -1rem 2rem;
}

.header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 16px;
}

.brand-section h1 {
  font-weight: 800;
  font-size: 2.2rem;
  margin: 0;
  background: var(--gradient-text);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.app-subtitle {
  color: var(--text-secondary);
  margin: 8px 0 0;
  font-size: 1rem;
}

.header-controls {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
}

.status-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 18px;
  border-radius: 16px;
  font-weight: 700;
  border: 2px solid transparent;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-size: 0.85rem;
  white-space: nowrap;
}

.status-badge.loaded {
  background: var(--success-bg);
  color: var(--success-color);
  border-color: var(--success-color);
}

.status-badge.not-loaded {
  background: var(--error-bg);
  color: var(--error-color);
  border-color: var(--error-color);
}

.cache-controls {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.btn-cache-action {
  padding: 8px 12px;
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  border-radius: 8px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: var(--transition-fast);
  display: flex;
  align-items: center;
  gap: 4px;
  white-space: nowrap;
}

.btn-cache-action:hover {
  background: var(--hover-bg);
  border-color: var(--primary-color);
}

.btn-cache-action.force-refresh {
  color: var(--warning-color);
  border-color: var(--warning-color);
}

.btn-cache-action.force-refresh:hover {
  background: var(--warning-bg);
}

/* **RESPONSIVE BREAKPOINTS MIGLIORATI** */
@media (max-width: 1200px) {
  .header-controls {
    gap: 12px;
  }
  
  .cache-controls {
    gap: 6px;
  }

  
}

@media (max-width: 992px) {
  .app-header {
    padding: 24px 20px;
    margin: 0 -0.5rem 1.5rem;
  }
  
  .brand-section h1 {
    font-size: 1.8rem;
  }
  
  .app-subtitle {
    font-size: 0.9rem;
  }
  
  .header-controls {
    width: 100%;
    justify-content: space-between;
  }
  
  .status-badge {
    padding: 8px 12px;
    font-size: 0.75rem;
  }
}

@media (max-width: 768px) {
  .app-header {
    padding: 20px 16px;
    margin: 0;
    border-radius: 0;
    border-left: none;
    border-right: none;
  }
  
  .header-content {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .brand-section h1 {
    font-size: 1.6rem;
  }
  
  .header-controls {
    width: 100%;
    flex-wrap: wrap;
    gap: 8px;
  }
  
  .cache-controls {
    order: 2;
    width: 100%;
    justify-content: space-between;
  }
  
  .theme-toggle {
    order: 1;
  }
  
  .btn-cache-action {
    flex: 1;
    justify-content: center;
    padding: 6px 8px;
    font-size: 0.7rem;
  }
  
  .btn-cache-action span {
    font-size: 14px;
  }
}

@media (max-width: 576px) {
  .app-header {
    padding: 16px 12px;
  }
  
  .brand-section h1 {
    font-size: 1.4rem;
  }
  
  .app-subtitle {
    font-size: 0.85rem;
  }
  
  .status-badge {
    font-size: 0.7rem;
    padding: 6px 10px;
  }
  
  .cache-controls {
    gap: 4px;
  }
}

/* **MAIN CONTAINER RESPONSIVO** */
.main-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

@media (max-width: 768px) {
  .main-container {
    padding: 10px;
    gap: 16px;
  }
}

@media (max-width: 576px) {
  .main-container {
    padding: 5px;
  }
}

/* **CONTROLS BAR RESPONSIVO** */
.controls-bar {
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
  overflow: hidden;
}

.control-panel-inner {
  padding: 18px 22px;
}

.panel-row {
  display: flex;
  gap: 14px;
  align-items: center;
  flex-wrap: wrap;
}

@media (max-width: 768px) {
  .control-panel-inner {
    padding: 16px;
  }
  
  .panel-row {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .panel-row.dual {
    grid-template-columns: 1fr;
  }
  
  .criteria-select-wrapper {
    width: 100%;
  }
  
  .btn-gradient,
  .btn-icon {
    width: 100%;
    justify-content: center;
  }
}

/* **RESULTS CARD RESPONSIVO** */
.results-header {
  padding: 24px 32px;
  border-bottom: 1px solid var(--border-color);
  background: var(--table-header-bg);
}

.results-toolbar {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

@media (max-width: 768px) {
  .results-header {
    padding: 16px 20px;
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .results-toolbar {
    width: 100%;
    justify-content: space-between;
  }
  
  .btn-export {
    flex: 1;
    justify-content: center;
    font-size: 0.8rem;
    padding: 8px 12px;
  }
}

/* **DATATABLE RESPONSIVO** */
.dataTables_wrapper {
  padding: 16px 20px;
}

@media (max-width: 768px) {
  .dataTables_wrapper {
    padding: 12px 16px;
  }
  
  .dataTables_length,
  .dataTables_filter {
    margin-bottom: 12px;
  }
  
  .dataTables_info,
  .dataTables_paginate {
    margin-top: 12px;
  }
}

/* **THEME TOGGLE MIGLIORATO** */
.theme-toggle {
  background: var(--card-bg);
  border: 2px solid var(--border-color);
  border-radius: 16px;
  width: 52px;
  height: 52px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition-normal);
}

.theme-toggle:hover {
  background: var(--hover-bg);
  transform: translateY(-2px) scale(1.05);
  box-shadow: var(--shadow-md);
}

@media (max-width: 768px) {
  .theme-toggle {
    width: 44px;
    height: 44px;
  }
}

@media (max-width: 576px) {
  .theme-toggle {
    width: 40px;
    height: 40px;
  }
}

/* **LOADING OVERLAY RESPONSIVO** */
.loading-content {
  padding: 24px 28px;
  border-radius: 14px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  margin: 0 1rem;
  max-width: 400px;
  width: 100%;
}

@media (max-width: 576px) {
  .loading-content {
    margin: 0 0.5rem;
    padding: 20px 24px;
  }
}

/* NAV full-bleed dentro main-container (solo qui) */
.main-container > nav.navbar{
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  width: 100vw;
  border-radius: 0;
  padding-left: max(env(safe-area-inset-left), 16px);
  padding-right: max(env(safe-area-inset-right), 16px);
  margin-top: -20px;
  margin-bottom: 20px;
}

/* Impilamento label+select dei wrapper Fantasquadra in mobile */
@media (max-width: 768px){
  #prevTeamWrapper,
  #prevTeamWrapperA,
  #prevTeamWrapperB{
    flex-direction: column !important;
    align-items: stretch !important;
    gap: 6px !important;
  }
  #prevTeamWrapper .form-label,
  #prevTeamWrapperA .form-label,
  #prevTeamWrapperB .form-label{
    margin: 0 0 4px !important;
  }
  .criteria-select{ width:100%; }
}
